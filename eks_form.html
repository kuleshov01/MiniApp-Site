<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ï–¥–∏–Ω–∞—è –∫–∞—Ä—Ç–∞ —Å–∞—Ö–∞–ª–∏–Ω—Ü–∞ - –ó–∞—è–≤–∫–∞</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 600px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }

        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 30px;
            font-size: 28px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            color: #555;
            font-weight: 500;
            font-size: 14px;
        }

        label.required::after {
            content: ' *';
            color: #e74c3c;
        }

        input[type="text"],
        input[type="tel"],
        select {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s;
        }

        input[type="text"]:focus,
        input[type="tel"]:focus,
        select:focus {
            outline: none;
            border-color: #667eea;
        }

        .checkbox-group {
            display: flex;
            align-items: flex-start;
            gap: 10px;
            margin-bottom: 12px;
        }

        .checkbox-group input[type="checkbox"] {
            margin-top: 4px;
            width: 18px;
            height: 18px;
            cursor: pointer;
        }

        .checkbox-group label {
            margin-bottom: 0;
            font-size: 13px;
            line-height: 1.4;
            cursor: pointer;
        }

        .checkbox-group label.required::after {
            content: '';
        }

        .checkbox-group.required label::after {
            content: ' *';
            color: #e74c3c;
        }

        button {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.4);
        }

        button:active {
            transform: translateY(0);
        }

        button:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }

        .result {
            margin-top: 20px;
            padding: 15px;
            border-radius: 8px;
            display: none;
        }

        .result.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .result.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .phone-input {
            position: relative;
        }

        .phone-input input {
            padding-left: 50px;
        }

        .phone-prefix {
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: #888;
            font-weight: 500;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üé´ –ó–∞—è–≤–∫–∞ –Ω–∞ "–ï–¥–∏–Ω—É—é –∫–∞—Ä—Ç—É —Å–∞—Ö–∞–ª–∏–Ω—Ü–∞"</h1>
        
        <form id="cardForm">
            <!-- –ë–∞–Ω–∫-–ø–∞—Ä—Ç–Ω–µ—Ä -->
            <div class="form-group">
                <label for="bank" class="required">–ë–∞–Ω–∫-–ø–∞—Ä—Ç–Ω–µ—Ä</label>
                <select id="bank" name="bank" required>
                    <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –±–∞–Ω–∫</option>
                    <option value="¬´–ì–∞–∑–ø—Ä–æ–º–±–∞–Ω–∫¬ª" data-id="gazp">–ì–∞–∑–ø—Ä–æ–º–±–∞–Ω–∫</option>
                    <option value="¬´–°–±–µ—Ä–ë–∞–Ω–∫¬ª" data-id="sber">–°–±–µ—Ä–ë–∞–Ω–∫</option>
                    <option value="¬´–í–¢–ë¬ª" data-id="vtb">–í–¢–ë</option>
                    <option value="¬´–ê–ª—å—Ñ–∞-–ë–∞–Ω–∫¬ª" data-id="alfa">–ê–ª—å—Ñ–∞-–ë–∞–Ω–∫</option>
                </select>
                <input type="hidden" id="bank-id" name="bank-id">
            </div>

            <!-- –ù–∞ –∫–æ–≥–æ –æ—Ñ–æ—Ä–º–ª—è–µ—Ç—Å—è –∫–∞—Ä—Ç–∞ -->
            <div class="form-group">
                <label for="forwhom" class="required">–ù–∞ –∫–æ–≥–æ –æ—Ñ–æ—Ä–º–ª—è–µ—Ç—Å—è –∫–∞—Ä—Ç–∞</label>
                <select id="forwhom" name="forwhom" required>
                    <option value="">–í—ã–±–µ—Ä–∏—Ç–µ</option>
                    <option value="–ù–∞ —Å–µ–±—è" data-id="self">–ù–∞ —Å–µ–±—è</option>
                    <option value="–ù–∞ —Ä–µ–±–µ–Ω–∫–∞" data-id="child">–ù–∞ —Ä–µ–±–µ–Ω–∫–∞</option>
                </select>
                <input type="hidden" id="forwhom-id" name="forwhom-id">
            </div>

            <!-- –§–∞–º–∏–ª–∏—è -->
            <div class="form-group">
                <label for="lastname" class="required">–§–∞–º–∏–ª–∏—è</label>
                <input type="text" id="lastname" name="lastname" required placeholder="–ò–≤–∞–Ω–æ–≤">
            </div>

            <!-- –ò–º—è -->
            <div class="form-group">
                <label for="name" class="required">–ò–º—è</label>
                <input type="text" id="name" name="name" required placeholder="–ò–≤–∞–Ω">
            </div>

            <!-- –û—Ç—á–µ—Å—Ç–≤–æ -->
            <div class="form-group">
                <label for="patron">–û—Ç—á–µ—Å—Ç–≤–æ</label>
                <input type="text" id="patron" name="patron" placeholder="–ò–≤–∞–Ω–æ–≤–∏—á">
            </div>

            <!-- –ú–æ–±–∏–ª—å–Ω—ã–π —Ç–µ–ª–µ—Ñ–æ–Ω -->
            <div class="form-group">
                <label for="mobPhone" class="required">–ú–æ–±–∏–ª—å–Ω—ã–π —Ç–µ–ª–µ—Ñ–æ–Ω</label>
                <div class="phone-input">
                    <span class="phone-prefix">+7</span>
                    <input type="tel" id="mobPhone" name="mobPhone" required placeholder="(999) 999-99-99">
                </div>
            </div>

            <!-- –ß–µ–∫–±–æ–∫—Å—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è -->
            <div class="form-group">
                <div class="checkbox-group">
                    <input type="checkbox" id="rstkAgree" name="rstkAgree">
                    <label for="rstkAgree">–Ø —Ö–æ—á—É –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å "–ï–¥–∏–Ω—É—é –∫–∞—Ä—Ç—É —Å–∞—Ö–∞–ª–∏–Ω—Ü–∞" –Ω–∞ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–µ</label>
                </div>

                <div class="checkbox-group">
                    <input type="checkbox" id="dolgoletieAgree" name="dolgoletieAgree">
                    <label for="dolgoletieAgree">–Ø —Ö–æ—á—É –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å "–ï–¥–∏–Ω—É—é –∫–∞—Ä—Ç—É —Å–∞—Ö–∞–ª–∏–Ω—Ü–∞" –≤ "–°–∞—Ö–∞–ª–∏–Ω—Å–∫–æ–º –¥–æ–ª–≥–æ–ª–µ—Ç–∏–∏"</label>
                </div>

                <div class="checkbox-group">
                    <input type="checkbox" id="aquaAgree" name="aquaAgree">
                    <label for="aquaAgree">–Ø —Ö–æ—á—É –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å "–ï–¥–∏–Ω—É—é –∫–∞—Ä—Ç—É —Å–∞—Ö–∞–ª–∏–Ω—Ü–∞" –≤ –ê–∫–≤–∞ –ü–∞—Ä–∫–µ (—Ç–æ–ª—å–∫–æ –¥–ª—è –¥–µ—Ç–µ–π)</label>
                </div>

                <div class="checkbox-group required">
                    <input type="checkbox" id="persAgree" name="persAgree" required>
                    <label for="persAgree">–Ø —Å–æ–≥–ª–∞—Å–µ–Ω –Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫—É –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö</label>
                </div>
            </div>

            <button type="submit" id="submitBtn">–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É</button>
        </form>

        <div id="result" class="result"></div>
    </div>

    <script>
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –≤—ã–±–æ—Ä–∞ –±–∞–Ω–∫–∞
        document.getElementById('bank').addEventListener('change', function() {
            const selectedOption = this.options[this.selectedIndex];
            const bankId = selectedOption.getAttribute('data-id');
            document.getElementById('bank-id').value = bankId || '';
        });

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –≤—ã–±–æ—Ä–∞ "–ù–∞ –∫–æ–≥–æ –æ—Ñ–æ—Ä–º–ª—è–µ—Ç—Å—è –∫–∞—Ä—Ç–∞"
        document.getElementById('forwhom').addEventListener('change', function() {
            const selectedOption = this.options[this.selectedIndex];
            const forwhomId = selectedOption.getAttribute('data-id');
            document.getElementById('forwhom-id').value = forwhomId || '';
        });

        // –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–µ–ª–µ—Ñ–æ–Ω–∞
        document.getElementById('mobPhone').addEventListener('input', function(e) {
            let value = e.target.value.replace(/\D/g, '');
            if (value.length > 10) value = value.slice(0, 10);
            
            let formatted = '';
            if (value.length > 0) formatted += '(' + value.slice(0, 3);
            if (value.length > 3) formatted += ') ' + value.slice(3, 6);
            if (value.length > 6) formatted += '-' + value.slice(6, 8);
            if (value.length > 8) formatted += '-' + value.slice(8, 10);
            
            e.target.value = formatted;
        });

        // –û—Ç–ø—Ä–∞–≤–∫–∞ —Ñ–æ—Ä–º—ã
        document.getElementById('cardForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const submitBtn = document.getElementById('submitBtn');
            const resultDiv = document.getElementById('result');
            
            submitBtn.disabled = true;
            submitBtn.textContent = '–û—Ç–ø—Ä–∞–≤–∫–∞...';
            resultDiv.style.display = 'none';
            
            try {
                // –§–æ—Ä–º–∏—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ —Ñ–æ—Ä–º—ã
                const formData = new FormData(this);
                const params = new URLSearchParams();
                
                // –î–æ–±–∞–≤–ª—è–µ–º –≤—Å–µ –ø–æ–ª—è
                for (const [key, value] of formData.entries()) {
                    if (value === 'on') {
                        params.append(key, 'on');
                    } else if (value) {
                        params.append(key, value);
                    }
                }
                
                // –î–æ–±–∞–≤–ª—è–µ–º timestamp
                params.append('n', Date.now().toString());
                
                // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞–ø—Ä–æ—Å
                const response = await fetch('https://eks.sakhalin.gov.ru/sendmail-bank-applying/', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/x-www-form-urlencoded; charset=UTF-8',
                        'X-Requested-With': 'XMLHttpRequest',
                        'Accept': '*/*',
                        'Accept-Language': 'ru-RU,ru;q=0.9,en-RU;q=0.8,en;q=0.7,en-US;q=0.6'
                    },
                    credentials: 'include',
                    body: params
                });
                
                const data = await response.json();
                
                if (response.ok) {
                    resultDiv.className = 'result success';
                    resultDiv.textContent = '‚úÖ –ó–∞—è–≤–∫–∞ —É—Å–ø–µ—à–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞!';
                } else {
                    resultDiv.className = 'result error';
                    resultDiv.textContent = '‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ: ' + (data.message || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞');
                }
                
                resultDiv.style.display = 'block';
                
            } catch (error) {
                resultDiv.className = 'result error';
                resultDiv.textContent = '‚ùå –û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è: ' + error.message;
                resultDiv.style.display = 'block';
            } finally {
                submitBtn.disabled = false;
                submitBtn.textContent = '–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É';
            }
        });
    </script>
</body>
</html>
